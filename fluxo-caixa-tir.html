<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calculadora de Fluxo de Caixa, VPL e TIR | SimulaLucro</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Calculadora gratuita de Fluxo de Caixa, VPL (Valor Presente L√≠quido), TIR (Taxa Interna de Retorno) e Montante. Simulador financeiro avan√ßado.">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f3f6fb;
  color:#1f2937;
  padding-bottom:90px;
}
.container{
  max-width:1000px;
  margin:auto;
  padding:24px 16px;
}
.card{
  background:#fff;
  padding:24px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
h1,h2{margin-top:0}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:16px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
}
input{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:1px solid #d1d5db;
}
select{
  padding:8px;
  border-radius:8px;
}
button{
  padding:12px 18px;
  border:none;
  border-radius:10px;
  background:#2563eb;
  color:#fff;
  font-weight:700;
  cursor:pointer;
}
button:hover{background:#1d4ed8}

.actions{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin-top:16px;
}

.result{
  margin-top:24px;
  padding:20px;
  background:#ecfeff;
  border-radius:12px;
}

.small{
  font-size:14px;
  color:#6b7280;
}
</style>
</head>

<body>

<div class="container">
  <div class="card">
    <h1>üìä Calculadora de Fluxo de Caixa, VPL e TIR</h1>
    <p>Simule investimentos com m√∫ltiplas entradas e sa√≠das de caixa.</p>

    <h2>Fluxo de Caixa</h2>

    <table id="fluxo">
      <thead>
        <tr>
          <th>Per√≠odo</th>
          <th>Tipo</th>
          <th>Valor (R$)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>0</td>
          <td>
            <select>
              <option value="-1">Sa√≠da</option>
              <option value="1">Entrada</option>
            </select>
          </td>
          <td><input type="number" value="10000"></td>
        </tr>
      </tbody>
    </table>

    <div class="actions">
      <button onclick="addLinha()">‚ûï Adicionar per√≠odo</button>
    </div>

    <h2>Par√¢metros</h2>

    <label>Taxa de juros por per√≠odo (%)</label>
    <input id="taxa" type="number" value="10">

    <div class="actions">
      <button onclick="calcular()">Calcular</button>
    </div>

    <div id="resultado" class="result" style="display:none"></div>
  </div>

  <div class="card" style="margin-top:40px">
    <h2>üìò Como usar esta calculadora</h2>

    <p><strong>Per√≠odo 0:</strong> normalmente representa o investimento inicial (sa√≠da).</p>
    <p><strong>Entradas:</strong> receitas futuras.</p>
    <p><strong>Sa√≠das:</strong> custos, aportes ou investimentos.</p>

    <h3>Exemplo de TIR</h3>
    <p>
      Investimento inicial: -10.000  
      <br>Entradas: 4.000 por 3 per√≠odos  
      <br>TIR indica se o investimento compensa.
    </p>

    <p class="small">
      Esta calculadora tem finalidade educativa e comparativa.
      N√£o constitui recomenda√ß√£o financeira.
    </p>
  </div>
</div>

<script>
function addLinha(){
  const tbody = document.querySelector("#fluxo tbody");
  const periodo = tbody.children.length;
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td>${periodo}</td>
    <td>
      <select>
        <option value="1">Entrada</option>
        <option value="-1">Sa√≠da</option>
      </select>
    </td>
    <td><input type="number" value="0"></td>
  `;
  tbody.appendChild(tr);
}

function calcular(){
  const rows = document.querySelectorAll("#fluxo tbody tr");
  const taxa = Number(document.getElementById("taxa").value)/100;

  let fluxos = [];
  rows.forEach(r=>{
    const tipo = Number(r.children[1].querySelector("select").value);
    const valor = Number(r.children[2].querySelector("input").value);
    fluxos.push(tipo * valor);
  });

  // VPL
  let vpl = 0;
  fluxos.forEach((f,i)=>{
    vpl += f / Math.pow(1+taxa,i);
  });

  // Montante
  let fv = 0;
  fluxos.forEach((f,i)=>{
    fv += f * Math.pow(1+taxa, fluxos.length-i-1);
  });

  // TIR (Newton-Raphson)
  let tir = 0.1;
  for(let k=0;k<1000;k++){
    let f=0, df=0;
    fluxos.forEach((v,i)=>{
      f += v / Math.pow(1+tir,i);
      df += -i * v / Math.pow(1+tir,i+1);
    });
    tir = tir - f/df;
  }

  const box = document.getElementById("resultado");
  box.style.display="block";
  box.innerHTML = `
    <strong>Resultados:</strong><br><br>
    üìâ <strong>VPL:</strong> R$ ${vpl.toFixed(2)}<br>
    üìà <strong>Montante (FV):</strong> R$ ${fv.toFixed(2)}<br>
    üîÅ <strong>TIR:</strong> ${(tir*100).toFixed(2)}% ao per√≠odo
  `;
}
</script>

</body>
</html>
