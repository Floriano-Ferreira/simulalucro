<script>
function n(v){ return Number(v) || 0 }

function toggleAvancado(){
  const box = document.getElementById("camposAvancados");
  box.style.display = box.style.display === "none" ? "block" : "none";
}

function calcular(){
  const capital = n(document.getElementById("inicial").value);
  const aporteMensal = n(document.getElementById("aporte").value);
  const taxaMensal = n(document.getElementById("taxa").value) / 100;
  const meses = n(document.getElementById("meses").value);

  if(capital <= 0 || taxaMensal <= 0 || meses <= 0){
    alert("Preencha os valores corretamente.");
    return;
  }

  let montante = capital;
  let totalInvestido = capital;

  for(let i = 1; i <= meses; i++){
    montante = (montante + aporteMensal) * (1 + taxaMensal);
    totalInvestido += aporteMensal;
  }

  /* ===== MODO AVANÃ‡ADO ===== */
  if(document.getElementById("modoAvancado").checked){
    const inflacaoAnual = n(document.getElementById("inflacao").value) / 100;
    const impostosPercentual = n(document.getElementById("impostos").value) / 100;

    if(inflacaoAnual > 0){
      const inflacaoMensal = Math.pow(1 + inflacaoAnual, 1/12) - 1;
      montante = montante / Math.pow(1 + inflacaoMensal, meses);
    }

    if(impostosPercentual > 0){
      montante = montante * (1 - impostosPercentual);
    }
  }

  const lucro = montante - totalInvestido;

  const resultado = document.getElementById("resultado");
  resultado.style.display = "block";
  resultado.innerHTML = `
    <strong>Resultado:</strong><br><br>
    ðŸ’µ Total investido: <strong>R$ ${totalInvestido.toFixed(2)}</strong><br>
    ðŸ“ˆ Valor final: <strong>R$ ${montante.toFixed(2)}</strong><br>
    ðŸ’° Juros ganhos: <strong>R$ ${lucro.toFixed(2)}</strong>
  `;
}
</script>
