<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>TIR, VPL e FV | SimulaLucro</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:#f3f6fb}
.container{max-width:900px;margin:auto;padding:24px}
.card{background:#fff;padding:24px;border-radius:16px}
input,select{padding:10px;border-radius:8px;border:1px solid #ccc}
button{padding:12px;border:none;border-radius:10px;background:#2563eb;color:#fff}
.row{display:grid;grid-template-columns:120px 120px 120px;gap:10px;margin-bottom:10px}
.result{background:#ecfeff;padding:16px;border-radius:12px;margin-top:20px}
</style>
</head>

<body>
<div class="container">
<div class="card">
<h1>ðŸ“ˆ TIR, VPL e Montante (FV)</h1>

<div id="fluxos">
  <div class="row">
    <input type="number" value="0" disabled>
    <input type="number" placeholder="Valor">
    <select><option value="-1">SaÃ­da</option><option value="1">Entrada</option></select>
  </div>
</div>

<button onclick="add()">+ Linha</button>

<br><br>
<label>Taxa de desconto (% por perÃ­odo)</label>
<input id="taxa" value="10">

<button onclick="calc()">Calcular</button>

<div id="out" class="result"></div>
</div>
</div>

<script>
function add(){
  let r=document.createElement("div");
  r.className="row";
  r.innerHTML=`<input type="number"><input type="number"><select>
  <option value="-1">SaÃ­da</option><option value="1">Entrada</option></select>`;
  fluxos.appendChild(r);
}

function calc(){
  let rows=[...document.querySelectorAll(".row")];
  let cf=[];
  rows.forEach((r,i)=>{
    let v=+r.children[1].value||0;
    let s=+r.children[2].value;
    cf.push(v*s);
  });

  let rate=(+taxa.value)/100;

  let vpl=cf.reduce((a,v,i)=>a+v/Math.pow(1+rate,i),0);
  let fv=cf.reduce((a,v,i)=>a+v*Math.pow(1+rate,cf.length-1-i),0);

  let irr=0.1;
  for(let k=0;k<1000;k++){
    let f=cf.reduce((a,v,i)=>a+v/Math.pow(1+irr,i),0);
    irr+=f>0?0.0001:-0.0001;
  }

  out.innerHTML=`
  <strong>VPL:</strong> R$ ${vpl.toFixed(2)}<br>
  <strong>FV:</strong> R$ ${fv.toFixed(2)}<br>
  <strong>TIR:</strong> ${(irr*100).toFixed(2)}%
  `;
}
</script>
</body>
</html>
